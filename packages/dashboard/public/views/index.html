<div class="" 
  data-ng-controller="DashboardController">

  <!-- Calorie Goal -->

  <div class="dashboard-section">

    <form class="form-inline" role="form">
      <div class="form-group">

        <h2>
            <label for="calorieGoal">Goal: </label>
            <input id="calorieGoal" class="form-control input-lg"style="width: 140px;" 
              type="text" maxlength="4"
              placeholder="How many?"
              ng-model="calorieGoal"
              ng-model-onblur
              ng-pattern="/^[0-9]{1,7}$/">
            <label for="calorieGoal"> calories per day.</label>

            <span class="label label-success"
              ng-show="">
              Yes!
            </span>
        </h2>
      
      </div>
    </form>
  </div>


  <!-- Add Journal Entry -->

  <div class="dashboard-section">
    <form id="addForm" class="form-inline" role="form">

      <h2 style="font-weight:bold;">
        Add Journal Entry: 
        <span class="label label-success">Added!</span>
      </h2>
      
      <table class="journalEntries" style="width: 100%;">
        <tbody class="journalDateRow">

          <tr class="journalItem">

            <td class="journalCell journalDate">
              <div class="form-group"
                ng-click="open($event)">
                <input type="text" class="form-control input" 
                  ng-model="newDate" 
                  ng-required="true"
                  datepicker-popup="{{format}}" 
                  is-open="opened" 
                  max-date="today"
                  show-weeks="false" 
                  show-button-bar="false" 
                  date-disabled="disabled(date, mode)" 
                  close-text="Close"/>
              </div>
            </td>

            <td class="journalCell journalTime">
              <div class="form-group">
                <timepicker-pop class="input-group"
                  ng-model="newTime"
                  input-time="newTime"  
                  disabled="disabled"
                  show-meridian="false"></timepicker-pop>
              </div>
            </td>

            <td class="journalCell journalDescription">
              <div class="form-group">
                <input type="text" class="form-control" 
                  id="addDescription" placeholder="Description?">
              </div>
            </td>

            <td class="journalCell journalCalories">
              <div class="form-group">
                <input id="addCalories" class="form-control"
                  type="text" maxlength="4"
                  placeholder="Calories?"
                  ng-model="addCalories"
                  ng-model-onblur
                  ng-pattern="/^[0-9]{1,7}$/">
              </div>
            </td>

            <td class="journalCell journalTools">
              <div class="form-group">
                <div class="input-group">
                  <button type="submit" class="btn btn-primary">
                    <i class="glyphicon glyphicon-plus"></i> 
                    <b>Add</b>
                  </button>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
  </div>

  <pre>New Entry is: <em>{{newDate}}, {{newTime}}, {{newDescription}}, {{newCalories}}</em></pre>


  <!-- Table of Journal Entries -->

  <div class="dashboard-section">
    <h2 style="font-weight:bold;">Calorie Journal:
      <span class="tag label label-info" ng-show="filter.dates.active">
        <span>Dates: {{filter.dates.from}} -> {{filter.dates.to}}</span>
        <a><i class="remove glyphicon glyphicon-remove glyphicon-white"></i></a> 
      </span>

      <span class="tag label label-info" ng-show="filter.times.active">
        <span>Times: {{filter.times.from}} -> {{filter.times.to}}</span>
        <a><i class="remove glyphicon glyphicon-remove glyphicon-white"></i></a> 
      </span>
    </h2> <!-- title and filter tags -->


    <!-- Filter forms -->

    <!-- Time filter form -->
    <form id="dateFilter" class="form-inline indent" 
      ng-show="showDateFilter" role="form">

      <h3>Date Filter</h3>
      <p>Show me only the entries between these two dates.</p>
      <div class="form-group">
        <!-- Starting and ending date controls -->
        <label class="sr-only" for="startDate">Start Date</label>
        <input style="width: 140px;" type="text" class="form-control input-lg" id="startDate" placeholder="Starting?">
        -
        <label class="sr-only" for="endDate">End Date</label>
        <input style="width: 140px;" type="text" class="form-control input-lg" id="endDate" placeholder="Ending?">
        <!-- Filter button -->
        <button type="submit" class="btn btn-primary">
          <i class="glyphicon glyphicon-filter"></i> 
          <b>Filter</b>
        </button>
        <!-- Cancel button -->
        <button type="submit" class="btn btn-default"
          ng-click="showDateFilter=false">
          Cancel
        </button>
      </div>
    </form>

    <!-- Time filter form -->
    <form id="timeFilter" class="form-inline indent" 
      ng-show="showTimeFilter" role="form">

      <h3>Time Filter</h3>
      <p>Show me only the entries, on all days, between these two times.</p>
      <div class="form-group">
        <!-- Starting and ending time controls -->
        <label class="sr-only" for="startDate">Start Time</label>
        <input style="width: 140px;" type="text" class="form-control input-lg" id="startTime" placeholder="Starting?">
        -
        <label class="sr-only" for="endDate">End Time</label>
        <input style="width: 140px;" type="text" class="form-control input-lg" id="endTime" placeholder="Ending?">
        <!-- Filter button -->
        <button type="submit" class="btn btn-primary">
          <i class="glyphicon glyphicon-filter"></i> 
          <b>Filter</b>
        </button>
        <!-- Cancel button -->
        <button  class="btn btn-default"
          ng-click="showTimeFilter=false" type="submit">
          Cancel
        </button>
      </div>
    </form>


    <!-- Journal Table -->

    <table class="journalEntries" style="width: 100%;">
      <thead>
        <tr class="journalRow journalHeader">

          <th class="journalCell journalDate">
            Date
            <button class="btn btn-sm btn-default" type="button"
              ng-model="showDateFilter" btn-checkbox>
              <i class="glyphicon glyphicon-filter"></i>
            </button>
          </th>


          <th class="journalCell journalTime">
            Time 
            <button class="btn btn-sm btn-default" type="button"
              ng-model="showTimeFilter" btn-checkbox>
              <i class="glyphicon glyphicon-filter"></i>
            </button>
          </th>

          <th class="journalCell journalDescription">
            Description
          </th>

          <th class="journalCell journalCalories">
            Calories
          </th>

          <th class="journalCell journalTools">
            &nbsp;
          </th>
        </tr>

      </thead> <!-- journalHeader -->

      <tbody class="journalDateRow" ng-class="date.display" 
        ng-repeat="date in journalEntries">

        <tr class="journalItem" 
          ng-repeat="item in date.entries"
          ng-show="item.filterDate && item.filterTime">

          <!-- Make the Date and Calories badge -->
          <td class="journalCell journalDate" style="position: relative;"
            ng-show="date.showDateSprite">

            <span class="journalDateSprite" ng-class="date.display" style="position: absolute; top: 10px; left: 10px;"
            ng-if="$first">
              <div class="spriteDate">{{date.date}}</div>
              <div class="spriteCount">{{date.calories}}</div>
              <div class="spriteLabel">calories</div>
            </span>
          </td>

          <!-- Maket the item cells-->
          <td class="journalCell journalDate"
            ng-hide="date.showDateSprite">

            <span
              editable-text="item.date"
              e-name="date" 
              e-form="rowform">
                {{ item.date }}
            </span>
          </td>

          <td class="journalCell journalTime">
            <span
              editable-text="item.time"
              e-name="date" 
              e-form="rowform">
                {{ item.time }}
            </span>
          </td>

          <td class="journalCell journalDescription">
            <span
              editable-text="item.description"
              e-name="description" 
              e-form="rowform">
                {{ item.description }}
            </span>
          </td>

          <td class="journalCell journalCalories">
            <span
              editable-text="item.calories"
              e-name="calories" 
              e-form="rowform">
                {{ item.calories }}
            </span>
          </td>

          <td class="journalCell journalTools">

            <!-- Row edit form -->
            <form class="form-buttons form-inline" 
              editable-form 
              name="rowform" 
              XXonbeforesave="saveUser($data, user.id)" 
              ng-show="rowform.$visible" 
              shown="inserted == item">
  
              <button class="btn btn-primary" type="submit"
                ng-disabled="rowform.$waiting">
                <i class="glyphicon glyphicon-ok"></i> 
              </button>
              <button class="btn btn-default" type="button" 
                ng-disabled="rowform.$waiting" 
                ng-click="rowform.$cancel()">
                <i class="glyphicon glyphicon-remove"></i> 
              </button>
            </form>

            <!-- Row view controls -->
            <div class="buttons" ng-show="!rowform.$visible">
              <button class="btn btn-primary" 
                ng-click="rowform.$show()">
                <i class="glyphicon glyphicon-edit"></i> 
              </button>
              <button class="btn btn-danger" 
                ng-click="removeUser($index)">
                  <i class="glyphicon glyphicon-trash"></i> 
              </button>
            </div>
          </td>

        </tr>
      </tbody>

    </table>

  </div> <!-- Section -->

</div>
